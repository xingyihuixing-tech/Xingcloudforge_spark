/* Global styles - most styles are in index.html inline or via Tailwind */

/* ===== 莫兰迪主题变量 ===== */

/* ... (Existing variables kept as is) ... */
/* 深色主题（默认） - 用户可自定义的颜色通过 CSS 变量覆盖 */
:root,
.theme-dark {
  --bg: var(--custom-dark-bg, #000000);
  --surface: color-mix(in srgb, var(--bg), #ffffff 8%);
  --panel: color-mix(in srgb, var(--bg), #ffffff 12%);
  --border: color-mix(in srgb, var(--bg), #ffffff 20%);

  --text-1: #EDEAE6;
  --text-2: #9A958E;
  --text-disabled: #6B665F;

  /* 5 类核心视觉元素（默认午夜星空配色） */
  --ui-primary: var(--custom-primary, #6366F1);
  /* 主交互色（靖蓝紫） */
  --ui-secondary: var(--custom-secondary, #A5B4FC);
  /* 次交互色（淡紫蓝） */
  --ui-secondary-rgb: var(--custom-secondary-rgb, 165, 180, 252);
  /* 次交互色RGB格式 */
  --ui-text-accent: var(--custom-text-accent, #818CF8);
  /* 标题强调（中紫蓝） */
  --ui-decoration: var(--custom-decoration, #4F46E5);
  /* 装饰线条（深靖蓝） */
  --ui-edit-bar: var(--custom-edit-bar, #14B8A6);
  /* 编辑栏（青色） */

  /* 兼容旧变量名（映射到新变量） */
  --accent: var(--ui-primary);
  --accent-hover: color-mix(in srgb, var(--ui-primary), white 20%);
  --accent-weak: color-mix(in srgb, var(--ui-primary), transparent 70%);
  --accent-2: var(--ui-secondary);

  --success: #20A162;
  --warning: #FF9F43;
  --danger: #FF6B6B;

  /* AI 助手变量 */
  --ai-glow-blue: #00f0ff;
  --ai-glow-purple: #bc13fe;
}


/* 主题应用到 body（仅影响UI控制台，3D场景背景独立控制） */
body {
  background-color: var(--bg);
  color: var(--text-1);
}

/* ===== Tailwind 颜色覆盖（适配新变量） ===== */

/* ... (Existing Tailwind overrides kept as is) ... */
/* 背景色覆盖 */
.bg-gray-900,
.bg-neutral-900,
.bg-neutral-900\/90 {
  background-color: var(--bg) !important;
}

.bg-gray-800,
.bg-gray-800\/50 {
  background-color: var(--surface) !important;
}

.bg-gray-700 {
  background-color: var(--panel) !important;
}

.bg-gray-600 {
  background-color: var(--border) !important;
}

/* 文本色覆盖 */
.text-gray-500,
.text-gray-400 {
  color: var(--text-2) !important;
}

.text-gray-300,
.text-gray-200 {
  color: var(--text-1) !important;
}

/* 边框色覆盖 */
.border-white\/10,
.border-gray-700,
.border-gray-600 {
  border-color: var(--border) !important;
}

/* 按钮色覆盖 - 映射到 primary */
.bg-blue-600 {
  background-color: var(--ui-primary) !important;
  color: #fff !important;
  /* 确保文字对比度 */
}

.bg-blue-600:hover,
.hover\:bg-blue-500:hover {
  background-color: var(--accent-hover) !important;
}

.bg-blue-600\/50 {
  background-color: var(--accent-weak) !important;
}

/* 次级颜色映射 */
.bg-purple-600 {
  background-color: var(--ui-decoration) !important;
  color: #fff !important;
}

.bg-orange-600 {
  background-color: var(--warning) !important;
}

.bg-green-600,
.bg-green-600\/80 {
  background-color: var(--success) !important;
  color: #fff !important;
}

.bg-red-600,
.bg-red-600\/50 {
  background-color: var(--danger) !important;
  color: #fff !important;
}

/* 标题/强调色 */
.text-blue-400 {
  color: var(--ui-text-accent) !important;
}

.text-purple-400,
.text-purple-300 {
  color: var(--ui-decoration) !important;
}

.text-orange-400,
.text-yellow-400 {
  color: var(--warning) !important;
}

.text-green-400 {
  color: var(--success) !important;
}

/* 滑块轨道样式 */
input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  background-color: var(--border) !important;
  height: 4px;
  border-radius: 2px;
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 12px;
  height: 12px;
  background-color: var(--ui-primary) !important;
  border: 1px solid var(--panel);
  border-radius: 50%;
  cursor: pointer;
  margin-top: -4px;
}

input[type="range"]::-moz-range-thumb {
  width: 12px;
  height: 12px;
  background-color: var(--ui-primary) !important;
  border: 1px solid var(--panel);
  border-radius: 50%;
  cursor: pointer;
}

input[type="range"]::-webkit-slider-runnable-track {
  height: 4px;
  border-radius: 2px;
  background-color: var(--border);
}

input[type="range"]::-moz-range-track {
  height: 4px;
  border-radius: 2px;
  background-color: var(--border);
}

/* 复选框样式 */
input[type="checkbox"] {
  accent-color: var(--ui-secondary) !important;
}

/* 选择框样式 */
select {
  background-color: var(--surface) !important;
  border: 1px solid var(--border) !important;
  color: var(--text-1) !important;
}

/* 输入框样式 */
input[type="text"],
input[type="number"] {
  background-color: var(--surface) !important;
  border: 1px solid var(--border) !important;
  color: var(--text-1) !important;
}

/* ===== 禁止iPad/移动端长按选中行为 ===== */
/* ... (Existing touch styles kept as is) ... */
body {
  -webkit-touch-callout: none;
  /* iOS禁用长按菜单 */
  -webkit-user-select: none;
  /* Safari禁用选中 */
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
  /* 禁用点击高亮 */
}

/* 允许输入框正常选中和输入 */
input[type="text"],
input[type="number"],
input[type="password"],
input[type="email"],
input[type="search"],
input[type="tel"],
input[type="url"],
textarea {
  -webkit-touch-callout: default;
  -webkit-user-select: text;
  -khtml-user-select: text;
  -moz-user-select: text;
  -ms-user-select: text;
  user-select: text;
}

/* 禁用Canvas上的长按菜单 */
canvas {
  -webkit-touch-callout: none;
  touch-action: none;
}

/* ===== XingForge AI 助手动画 ===== */

@keyframes ai-float {
  0% {
    transform: translateY(0px);
  }

  50% {
    transform: translateY(-3px);
  }

  100% {
    transform: translateY(0px);
  }
}

@keyframes ai-scan {
  0% {
    transform: translateX(-100%);
    opacity: 0;
  }

  50% {
    opacity: 1;
  }

  100% {
    transform: translateX(100%);
    opacity: 0;
  }
}

@keyframes ai-pulse-border {
  0% {
    border-color: rgba(99, 102, 241, 0.3);
    box-shadow: 0 0 10px rgba(99, 102, 241, 0.1), inset 0 0 5px rgba(99, 102, 241, 0.1);
  }

  50% {
    border-color: rgba(99, 102, 241, 0.6);
    box-shadow: 0 0 20px rgba(99, 102, 241, 0.3), inset 0 0 10px rgba(99, 102, 241, 0.2);
  }

  100% {
    border-color: rgba(99, 102, 241, 0.3);
    box-shadow: 0 0 10px rgba(99, 102, 241, 0.1), inset 0 0 5px rgba(99, 102, 241, 0.1);
  }
}

@keyframes ai-think-pulse {
  0% {
    transform: scale(1);
    opacity: 0.5;
  }

  50% {
    transform: scale(1.05);
    opacity: 1;
    filter: brightness(1.2);
  }

  100% {
    transform: scale(1);
    opacity: 0.5;
  }
}

@keyframes message-fade-in {
  from {
    opacity: 0;
    transform: translateY(5px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.ai-glass-panel {
  background: linear-gradient(135deg, rgba(30, 41, 59, 0.85) 0%, rgba(15, 23, 42, 0.95) 100%);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  border: 1px solid rgba(255, 255, 255, 0.1);
  box-shadow:
    0 25px 50px -12px rgba(0, 0, 0, 0.5),
    0 0 0 1px rgba(255, 255, 255, 0.05) inset;
}

.ai-glow-effect {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-radius: inherit;
  pointer-events: none;
  z-index: -1;
  background: radial-gradient(circle at 50% 100%, rgba(99, 102, 241, 0.15), transparent 70%);
}

.ai-typing-cursor::after {
  content: '|';
  animation: blink 1s step-start infinite;
  color: var(--ui-primary);
}

@keyframes blink {
  50% {
    opacity: 0;
  }
}

/* AI Vortex Star Button */
@keyframes vortex-spin {
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
}

/* AI Star Entrance - Static Shape, Rotating Gradient */
@property --star-angle {
  syntax: '<angle>';
  initial-value: 0deg;
  inherits: false;
}

@keyframes star-spin {
  0% {
    --star-angle: 0deg;
  }

  100% {
    --star-angle: 360deg;
  }
}

.ai-star-container {
  clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
  background: transparent;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: transform 0.3s ease;
  overflow: hidden;
}

.ai-star-container::before {
  content: '';
  position: absolute;
  inset: -50%;
  background: conic-gradient(from var(--star-angle), #06b6d4, #f472b6, #22d3ee, #06b6d4);
  animation: star-spin 3s linear infinite;
}

.ai-star-container:hover {
  transform: scale(1.1);
  filter: drop-shadow(0 0 8px rgba(34, 211, 238, 0.6));
}

/* XingSpark Logo - Dynamic Orbit Gradient (Reference Style) */
@property --xing-angle {
  syntax: '<angle>';
  initial-value: 0deg;
  inherits: false;
}

@property --xing-cx {
  syntax: '<percentage>';
  initial-value: 50%;
  inherits: false;
}

@property --xing-cy {
  syntax: '<percentage>';
  initial-value: 50%;
  inherits: false;
}

@keyframes xing-rotate-angle {
  from {
    --xing-angle: 0deg;
  }

  to {
    --xing-angle: 360deg;
  }
}

@keyframes xing-orbit-move {

  0%,
  100% {
    --xing-cx: 35%;
    --xing-cy: 45%;
  }

  25% {
    --xing-cx: 65%;
    --xing-cy: 35%;
  }

  50% {
    --xing-cx: 75%;
    --xing-cy: 65%;
  }

  75% {
    --xing-cx: 25%;
    --xing-cy: 75%;
  }
}

@keyframes logo-blink {

  0%,
  100% {
    opacity: 1;
  }

  50% {
    opacity: 0.3;
  }
}

.xingspark-logo {
  font-family: 'Pacifico', cursive;
  font-size: 1.4rem;
  background: conic-gradient(from var(--xing-angle) at var(--xing-cx) var(--xing-cy),
      #71b0ff, #FFB6C1, #2bf6a5, #37f1d2, #71b0ff);
  animation: xing-rotate-angle 4s linear infinite, xing-orbit-move 10s ease-in-out infinite;
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  color: transparent;
  filter: saturate(120%) brightness(105%);
  cursor: pointer;
  user-select: none;
}

.xingspark-logo.blinking {
  animation: xing-rotate-angle 4s linear infinite, xing-orbit-move 10s ease-in-out infinite, logo-blink 0.5s ease-in-out infinite;
}

/* XingSpark Logo Glow Layer */
.xingspark-glow {
  position: absolute;
  inset: 0;
  font-family: 'Pacifico', cursive;
  font-size: 1.4rem;
  color: #71b0ff;
  filter: blur(6px);
  opacity: 0.6;
  pointer-events: none;
}

/* AI Panel - Glassmorphism + 4 Segment Breathe Borders (Reference Style) */
@keyframes breathe {

  0%,
  100% {
    opacity: 0.6;
  }

  50% {
    opacity: 1;
  }
}

.ai-panel-container {
  position: relative;
  height: 600px;
  /* Fixed Height */
  display: flex;
  flex-direction: column;
  /* Glassmorphism - Dark Mode Only */
  background: rgba(15, 23, 42, 0.12);
  backdrop-filter: blur(24px);
  -webkit-backdrop-filter: blur(24px);
  border-radius: 16px;
  box-shadow:
    0 24px 48px rgba(0, 0, 0, 0.15),
    0 8px 16px rgba(0, 0, 0, 0.1),
    0 0 20px rgba(6, 182, 212, 0.15),
    0 0 40px rgba(244, 114, 182, 0.1);
  overflow: hidden;
}

/* Top Border Segment */
.ai-panel-border-top {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  pointer-events: none;
  background: linear-gradient(90deg, transparent 0%, #06b6d4 20%, #f472b6 50%, #22d3ee 80%, transparent 100%);
  animation: breathe 3.5s ease-in-out infinite;
}

/* Bottom Border Segment */
.ai-panel-border-bottom {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 2px;
  pointer-events: none;
  background: linear-gradient(90deg, transparent 0%, #22d3ee 20%, #f472b6 50%, #06b6d4 80%, transparent 100%);
  animation: breathe 3.5s ease-in-out infinite;
}

/* Left Border Segment */
.ai-panel-border-left {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 2px;
  pointer-events: none;
  background: linear-gradient(to bottom, rgba(6, 182, 212, 0.8) 0%, rgba(244, 114, 182, 0.5) 30%, rgba(34, 211, 238, 0.25) 70%, transparent 100%);
  animation: breathe 3.5s ease-in-out infinite;
}

/* Right Border Segment */
.ai-panel-border-right {
  position: absolute;
  right: 0;
  top: 0;
  bottom: 0;
  width: 2px;
  pointer-events: none;
  background: linear-gradient(to bottom, transparent 0%, rgba(34, 211, 238, 0.25) 30%, rgba(244, 114, 182, 0.5) 70%, rgba(6, 182, 212, 0.8) 100%);
  animation: breathe 3.5s ease-in-out infinite;
}

/* AI Input Box - Reference Style Flowing Glow (Only During Refining) */
@property --flow-angle {
  syntax: '<angle>';
  initial-value: 0deg;
  inherits: false;
}

@keyframes flow-rotate {
  to {
    --flow-angle: 360deg;
  }
}

/* Dual-point flowing glow animation */
@keyframes glowFlowDual {

  0%,
  100% {
    box-shadow:
      -10px -5px 12px rgba(113, 176, 255, 0.25),
      -5px -2px 6px rgba(113, 176, 255, 0.15),
      10px 5px 12px rgba(255, 182, 193, 0.25),
      5px 2px 6px rgba(255, 182, 193, 0.15);
  }

  25% {
    box-shadow:
      5px -10px 12px rgba(113, 176, 255, 0.25),
      2px -5px 6px rgba(113, 176, 255, 0.15),
      -5px 10px 12px rgba(255, 182, 193, 0.25),
      -2px 5px 6px rgba(255, 182, 193, 0.15);
  }

  50% {
    box-shadow:
      10px 5px 12px rgba(43, 246, 165, 0.25),
      5px 2px 6px rgba(43, 246, 165, 0.15),
      -10px -5px 12px rgba(55, 241, 210, 0.25),
      -5px -2px 6px rgba(55, 241, 210, 0.15);
  }

  75% {
    box-shadow:
      -5px 10px 12px rgba(43, 246, 165, 0.25),
      -2px 5px 6px rgba(43, 246, 165, 0.15),
      5px -10px 12px rgba(55, 241, 210, 0.25),
      2px -5px 6px rgba(55, 241, 210, 0.15);
  }
}

.ai-input-container {
  position: relative;
  border-radius: 12px;
  background: transparent;
  /* No background fill - transparent */
  border: 1px solid rgba(113, 176, 255, 0.3);
  transition: border-color 0.3s ease, box-shadow 0.3s ease;
}

/* Refining State: Activate Flow Glow Animation */
.ai-input-container.refining {
  border-color: rgba(113, 176, 255, 0.5);
  animation: glowFlowDual 6s ease-in-out infinite;
}